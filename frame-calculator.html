<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Frame Cut List + Rabbet Check</title>
  <style>
    body { font-family: sans-serif; max-width: 900px; margin: auto; padding: 2rem; }
    label { display: block; margin-top: 1em; font-weight: bold; }
    input, select, textarea, button {
      width: 100%;
      padding: 0.5em;
      margin-top: 0.25em;
      font-size: 1em;
    }
    .result {
      margin-top: 2em;
      padding: 1em;
      border: 1px solid #ccc;
      border-radius: 8px;
      background: #f9f9f9;
    }
    canvas {
      margin-top: 1em;
      border: 1px solid #ccc;
      width: 100%;
      max-width: 600px;
      height: auto;
    }
    .warning {
      color: darkred;
      font-weight: bold;
      margin-top: 1em;
    }

    @media (max-width: 600px) {
      body { padding: 1rem; }
      input, select, textarea, button { font-size: 1em; }
      canvas { width: 100% !important; height: auto !important; }
    }
  </style>
</head>
<body>

  <h1>Frame Cut List & Rabbet Fit Checker</h1>

  <label>Artwork Width (inches): <input type="number" id="artWidth" step="0.01"></label>
  <label>Artwork Height (inches): <input type="number" id="artHeight" step="0.01"></label>
  <label>Artwork Thickness (inches): <input type="number" id="artworkThickness" step="0.01" value="0.75"></label>
  <label>Include 1/2" Strainer? <select id="strainer"><option value="no">No</option><option value="yes">Yes</option></select></label>
  <label>Include Matting? <select id="matting"><option value="no">No</option><option value="yes">Yes</option></select></label>
  <label>Include Spacer? <select id="spacer"><option value="no">No</option><option value="yes">Yes</option></select></label>
  <label>Include Plexiglass? <select id="plexi"><option value="no">No</option><option value="yes">Yes</option></select></label>

  <label>Face Width (inches): <input type="number" id="faceWidth" step="0.01" value="0.75"></label>
  <label>Wood Type:
    <select id="woodType">
      <option value="cherry">Cherry (cheap)</option>
      <option value="maple">Maple (mid)</option>
      <option value="walnut">Walnut (premium)</option>
    </select>
  </label>
  <label>Price per Board Foot: <input type="number" id="customPrice" step="0.01" placeholder="Optional override..."></label>

  <label>Quantity: <input type="number" id="quantity" value="1" min="1"></label>
  <label>Client / Project Notes: <textarea id="notes" rows="4" placeholder="Optional notes or special instructions..."></textarea></label>

  <button onclick="calculate()">Calculate Cut List</button>

  <div class="result" id="output" style="display:none;">
    <h3>Cut List & Estimate</h3>
    <div id="cutList"></div>
    <div id="priceEstimate"></div>
    <div id="rabbetEstimate" style="margin-top: 1em; font-style: italic;"></div>
    <canvas id="diagramTop" width="600" height="400"></canvas>
    <canvas id="diagramSide" width="600" height="200"></canvas>
  </div>

  <script>
    function calculate() {
      const width = parseFloat(document.getElementById("artWidth").value);
      const height = parseFloat(document.getElementById("artHeight").value);
      const artwork = parseFloat(document.getElementById("artworkThickness").value) || 0.75;
      const hasStrainer = document.getElementById("strainer").value === "yes";
      const hasMat = document.getElementById("matting").value === "yes";
      const hasSpacer = document.getElementById("spacer").value === "yes";
      const hasPlexi = document.getElementById("plexi").value === "yes";
      const faceWidth = parseFloat(document.getElementById("faceWidth").value) || 0.75;
      const qty = parseInt(document.getElementById("quantity").value);
      const customPrice = parseFloat(document.getElementById("customPrice").value);
      const wood = document.getElementById("woodType").value;
      const baseRates = { maple: 5.5, cherry: 4.0, walnut: 8.0 };

      if (!width || !height || qty < 1) {
        alert("Please enter valid artwork dimensions and quantity.");
        return;
      }

      // Automatic Rabbet and Profile Depth Calculation
      let rabbet = artwork;
      if (hasStrainer) rabbet += 0.5;
      if (hasMat) rabbet += 0.25;
      if (hasSpacer) rabbet += 0.125;
      if (hasPlexi) rabbet += 0.125;
      rabbet += 0.25; // for pins/hardware
      rabbet = parseFloat(rabbet.toFixed(3));

      let profile = parseFloat((rabbet + 0.25).toFixed(3));

      // Mat allowance for inside fit
      const matAllowance = hasMat ? 0.5 : 0.25;
      const totalWidth = width + matAllowance;
      const totalHeight = height + matAllowance;

      const sideA = totalWidth + (2 * rabbet);
      const sideB = totalHeight + (2 * rabbet);
      const outsideWidth = totalWidth + (2 * profile);
      const outsideHeight = totalHeight + (2 * profile);

      const perimeter = 2 * (sideA + sideB);
      const thickness = 0.75;
      const boardFeetPerFrame = (thickness * faceWidth * perimeter) / 144;
      const boardFootRate = customPrice || baseRates[wood];
      const profileMultiplier = profile > 1.5 ? 1.2 : 1.0;
      const finalCost = (boardFeetPerFrame * boardFootRate * profileMultiplier * qty).toFixed(2);

      document.getElementById("cutList").innerHTML = `
        <strong>Frame Side Cuts (per frame):</strong><br>
        - ${sideA.toFixed(2)}" x 2<br>
        - ${sideB.toFixed(2)}" x 2<br>
        <br><em>Mitered 45° corners. Add 2” total for join clearance.</em><br><br>
        <strong>Inside Frame Dimensions (Rabbet Fit):</strong><br>
        - Width: ${totalWidth.toFixed(2)}"<br>
        - Height: ${totalHeight.toFixed(2)}"<br><br>
        <strong>Outside Frame Dimensions:</strong><br>
        - Width: ${outsideWidth.toFixed(2)}"<br>
        - Height: ${outsideHeight.toFixed(2)}"
      `;

      document.getElementById("priceEstimate").innerHTML = `
        <strong>Estimate:</strong> $${finalCost} for ${qty} frame(s)<br>
        - Wood: ${wood.charAt(0).toUpperCase() + wood.slice(1)} @ $${boardFootRate.toFixed(2)}/bdft<br>
        - Profile Depth: ${profile}"<br>
        - Board Feet: ${boardFeetPerFrame.toFixed(3)} bdft/frame
      `;

      document.getElementById("rabbetEstimate").innerHTML =
        `Auto-calculated rabbet depth: <strong>${rabbet}"</strong><br>` +
        `Includes: artwork${hasStrainer ? " + strainer" : ""}${hasMat ? " + mat" : ""}${hasSpacer ? " + spacer" : ""}${hasPlexi ? " + plexi" : ""} + 0.25" hardware<br>` +
        `Auto-calculated profile depth: <strong>${profile}"</strong>`;

      document.getElementById("output").style.display = "block";
      drawTopDiagram(outsideWidth, outsideHeight, width, height, hasMat);
      drawSideDiagram(rabbet, artwork, hasStrainer, hasMat, hasSpacer, hasPlexi);
    }

    function drawTopDiagram(outW, outH, artW, artH, matting) {
  const canvas = document.getElementById("diagramTop");
  const ctx = canvas.getContext("2d");
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const margin = 40;
  const scale = Math.min((canvas.width - margin * 2) / outW, (canvas.height - margin * 2) / outH);
  const offsetX = (canvas.width - outW * scale) / 2;
  const offsetY = (canvas.height - outH * scale) / 2;

  // Outer frame (outside dimensions)
  ctx.strokeStyle = "#333";
  ctx.lineWidth = 2;
  ctx.strokeRect(offsetX, offsetY, outW * scale, outH * scale);

  // Artwork (inside fit area)
  const matAllowance = matting ? 0.5 : 0.25;
  const insideW = artW + matAllowance;
  const insideH = artH + matAllowance;
  const artBoxW = insideW * scale;
  const artBoxH = insideH * scale;
  const innerX = offsetX + (outW * scale - artBoxW) / 2;
  const innerY = offsetY + (outH * scale - artBoxH) / 2;

  ctx.strokeStyle = "#aaa";
  ctx.lineWidth = 1;
  ctx.strokeRect(innerX, innerY, artBoxW, artBoxH);

  // Outside dimension labels
  ctx.fillStyle = "#000";
  ctx.font = "14px sans-serif";
  ctx.textAlign = "center";
  ctx.fillText(`Outside Width: ${outW.toFixed(2)}"`, offsetX + (outW * scale) / 2, offsetY - 10);

  ctx.save();
  ctx.translate(offsetX - 10, offsetY + (outH * scale) / 2);
  ctx.rotate(-Math.PI / 2);
  ctx.fillText(`Outside Height: ${outH.toFixed(2)}"`, 0, 0);
  ctx.restore();

  // Inside dimension labels
  ctx.fillStyle = "#444";
  ctx.textAlign = "left";
  ctx.fillText(`Inside Width: ${insideW.toFixed(2)}"`, innerX, innerY - 8);

  ctx.save();
  ctx.translate(innerX - 8, innerY + (artBoxH / 2));
  ctx.rotate(-Math.PI / 2);
  ctx.fillText(`Inside Height: ${insideH.toFixed(2)}"`, 0, 0);
  ctx.restore();
}

  function drawSideDiagram(rabbetDepth, artwork, hasStrainer, hasMat, hasSpacer, hasPlexi) {
  const canvas = document.getElementById("diagramSide");
  const ctx = canvas.getContext("2d");
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const baseY = 160;
  const scale = 100;

  // Layer thicknesses
  const layers = [];
  layers.push({ name: "Artwork", height: artwork, color: "#aaa" });
  if (hasStrainer) layers.unshift({ name: "Strainer", height: 0.5, color: "#888" });
  if (hasMat) layers.unshift({ name: "Matting", height: 0.25, color: "#bbb" });
  if (hasSpacer) layers.unshift({ name: "Spacer", height: 0.125, color: "#ccc" });
  if (hasPlexi) layers.unshift({ name: "Plexiglass", height: 0.125, color: "#e0e0e0" });
  layers.push({ name: "Hardware Gap", height: 0.25, color: null }); // Just a label, no visual block

  const profileDepth = rabbetDepth + 0.25;
  const profileHeight = profileDepth * scale;

  // Draw rabbet box
  const rabbetHeight = rabbetDepth * scale;
  ctx.strokeStyle = "#333";
  ctx.lineWidth = 2;
  ctx.strokeRect(100, baseY - rabbetHeight, 40, rabbetHeight);
  ctx.fillStyle = "#000";
  ctx.fillText("Rabbet", 100, baseY - rabbetHeight - 8);

  // Draw stacked layers inside the rabbet
  let currentY = baseY;
  layers.forEach(layer => {
    const h = layer.height * scale;
    currentY -= h;
    if (layer.color) {
      ctx.fillStyle = layer.color;
      ctx.fillRect(150, currentY, 40, h);
    }
    ctx.fillStyle = "#000";
    ctx.fillText(layer.name, 195, currentY + h / 2);
  });

  // Inside Height Dimension
  ctx.strokeStyle = "#444";
  ctx.lineWidth = 1;
  ctx.beginPath();
  ctx.moveTo(85, baseY);
  ctx.lineTo(85, baseY - rabbetHeight);
  ctx.stroke();
  ctx.beginPath();
  ctx.moveTo(80, baseY);
  ctx.lineTo(90, baseY);
  ctx.moveTo(80, baseY - rabbetHeight);
  ctx.lineTo(90, baseY - rabbetHeight);
  ctx.stroke();
  ctx.fillStyle = "#444";
  ctx.font = "12px sans-serif";
  ctx.fillText(`${rabbetDepth.toFixed(3)}" inside`, 10, baseY - rabbetHeight / 2);

  // Outside Height Dimension (Profile)
  ctx.strokeStyle = "#000";
  ctx.lineWidth = 1.5;
  ctx.beginPath();
  ctx.moveTo(250, baseY);
  ctx.lineTo(250, baseY - profileHeight);
  ctx.stroke();
  ctx.beginPath();
  ctx.moveTo(245, baseY);
  ctx.lineTo(255, baseY);
  ctx.moveTo(245, baseY - profileHeight);
  ctx.lineTo(255, baseY - profileHeight);
  ctx.stroke();
  ctx.fillStyle = "#000";
  ctx.fillText(`${profileDepth.toFixed(3)}" profile`, 260, baseY - profileHeight / 2);
}

  </script>

</body>
</html>
